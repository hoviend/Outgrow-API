-- Create "master_account_types" table
CREATE TABLE "master_account_types" (
    "id" bigint NOT NULL GENERATED BY DEFAULT AS IDENTITY,
    "name" character varying NOT NULL,
    "created_at" timestamptz NOT NULL DEFAULT CURRENT_TIMESTAMP,
    PRIMARY KEY ("id")
);
-- Create index "master_account_types_name_key" to table: "master_account_types"
CREATE UNIQUE INDEX "master_account_types_name_key" ON "master_account_types" ("name");
-- Create "master_event_types" table
CREATE TABLE "master_event_types" (
    "id" bigint NOT NULL GENERATED BY DEFAULT AS IDENTITY,
    "name" character varying NOT NULL,
    "description" character varying NOT NULL,
    "rules" jsonb NOT NULL,
    "created_at" timestamptz NOT NULL DEFAULT CURRENT_TIMESTAMP,
    PRIMARY KEY ("id")
);
-- Create index "master_event_types_name_key" to table: "master_event_types"
CREATE UNIQUE INDEX "master_event_types_name_key" ON "master_event_types" ("name");
-- Create "organization_account_types" table
CREATE TABLE "organization_account_types" (
    "id" bigint NOT NULL GENERATED BY DEFAULT AS IDENTITY,
    "name" character varying NOT NULL,
    "created_at" timestamptz NOT NULL DEFAULT CURRENT_TIMESTAMP,
    "organization_id" uuid NOT NULL REFERENCES "organizations" ("id") ON DELETE RESTRICT ON UPDATE CASCADE,
    PRIMARY KEY ("id")
);
-- Create index "organization_account_types_name_key" to table: "organization_account_types"
CREATE UNIQUE INDEX "organization_account_types_name_key" ON "organization_account_types" ("name");
-- Create "organization_account_categories" table
CREATE TABLE "organization_account_categories" (
    "id" bigint NOT NULL GENERATED BY DEFAULT AS IDENTITY,
    "name" character varying NOT NULL,
    "description" text NULL,
    "created_at" timestamptz NOT NULL DEFAULT CURRENT_TIMESTAMP,
    "account_type_id" bigint NOT NULL REFERENCES "organization_account_types" ("id") ON DELETE RESTRICT ON UPDATE CASCADE,
    PRIMARY KEY ("id")
);
-- Create "organization_accounts" table
CREATE TABLE "organization_accounts" (
    "id" bigint NOT NULL GENERATED BY DEFAULT AS IDENTITY,
    "parent_id" bigint NULL,
    "name" character varying NOT NULL,
    "created_at" timestamptz NOT NULL DEFAULT CURRENT_TIMESTAMP,
    "category_id" bigint NOT NULL REFERENCES "organization_account_categories" ("id") ON DELETE RESTRICT ON UPDATE CASCADE,
    PRIMARY KEY ("id")
);
-- Create "organization_event_types" table
CREATE TABLE "organization_event_types" (
    "id" bigint NOT NULL GENERATED BY DEFAULT AS IDENTITY,
    "name" character varying NOT NULL,
    "description" character varying NOT NULL,
    "rules" jsonb NOT NULL, "created_at" timestamptz NOT NULL DEFAULT CURRENT_TIMESTAMP,
    "organization_id" uuid NOT NULL REFERENCES "organizations" ("id") ON DELETE RESTRICT ON UPDATE CASCADE,
    PRIMARY KEY ("id")
);
-- Create index "organization_event_types_name_key" to table: "organization_event_types"
CREATE UNIQUE INDEX "organization_event_types_name_key" ON "organization_event_types" ("name");
-- Create "transactions" table
CREATE TABLE "transactions" (
    "id" uuid NOT NULL,
    "transaction_date" date NOT NULL,
    "transaction_type" character varying NOT NULL,
    "amount" double precision NOT NULL DEFAULT 0,
    "notes" text NULL,
    "created_at" timestamptz NOT NULL DEFAULT CURRENT_TIMESTAMP,
    "account_id" bigint NOT NULL REFERENCES "organization_accounts" ("id") ON DELETE RESTRICT ON UPDATE CASCADE,
    PRIMARY KEY ("id")
);
-- Create "master_account_categories" table
CREATE TABLE "master_account_categories" (
    "id" bigint NOT NULL GENERATED BY DEFAULT AS IDENTITY,
    "account_type_id" bigint NOT NULL REFERENCES "master_account_types" ("id") ON DELETE RESTRICT ON UPDATE CASCADE,
    "name" character varying NOT NULL,
    "description" text NULL,
    "created_at" timestamptz NOT NULL DEFAULT CURRENT_TIMESTAMP,
    PRIMARY KEY ("id")
);
-- Create "master_accounts" table
CREATE TABLE "master_accounts" (
    "id" bigint NOT NULL GENERATED BY DEFAULT AS IDENTITY,
    "parent_id" bigint NULL,
    "name" character varying NOT NULL,
    "created_at" timestamptz NOT NULL DEFAULT CURRENT_TIMESTAMP,
    "category_id" bigint NOT NULL REFERENCES "master_account_categories" ("id") ON DELETE RESTRICT ON UPDATE CASCADE,
    PRIMARY KEY ("id")
);
